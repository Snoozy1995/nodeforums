extends layouts/main.pug

block page
  .ui.mini.fluid.two.item.menu
    a.item.active(href="/login") Login
    a.item(href="/register") Register
  h1.ui.header Login
  .ui.inverted.red.segment
    p Response from server: $$$
  form.ui.fluid.form
    .field
      .ui.fluid.icon.input
        input(placeholder="Username",type="text",id="username",required)
        i.icon
    .ui.divider
    .field
      .ui.fluid.icon.input
        input(placeholder="Password",type="password",id="password",autocomplete="current-password",minlength="6",required)
        i.icon
      .ui.pointing.label Please enter a value
    .ui.divider
    .field
      a.ui.fluid.positive.button.loginbutton Login
  script.
    $(".loginbutton").click(function(){
      sha256($('#password').val()).then(function(digest) {
        socket.emit("login",$("#username").val(),digest);
      });
    });
    function sha256(str) {
    var buffer = new TextEncoder("utf-8").encode(str);
    return crypto.subtle.digest("SHA-256", buffer).then(function (hash) {
    return hex(hash);
    });
    }
    function hex(buffer) {
    var hexCodes = [];
    var view = new DataView(buffer);
    for (var i = 0; i < view.byteLength; i += 4) {
    var value = view.getUint32(i);
    var stringValue = value.toString(16);
    var padding = '00000000';
    var paddedValue = (padding + stringValue).slice(-padding.length);
    hexCodes.push(paddedValue);
    }
    return hexCodes.join("");
    }